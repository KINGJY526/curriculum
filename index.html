<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>디자인컨버전스학부 이수체계 (모바일)</title>
  <link rel="stylesheet" href="styles.css?v=2025-08-12-2" />
</head>
<body>
  <!-- 상단 바 -->
  <header class="topbar">
    <div class="brand">이수체계</div>
    <div class="actions">
      <button class="icon-btn" aria-label="검색" id="openSearch">⌕</button>
      <button class="icon-btn" aria-label="도움말" id="openHelp">?</button>
    </div>
  </header>

  <!-- 탭 & 필터 -->
  <section class="controls">
    <div class="tabs" id="semesterTabs" role="tablist" aria-label="학기 선택">
      <button class="tab is-active" data-semester="ALL" role="tab">전체</button>
      <button class="tab" data-semester="1-1" role="tab">1-1</button>
      <button class="tab" data-semester="1-2" role="tab">1-2</button>
      <button class="tab" data-semester="2-1" role="tab">2-1</button>
      <button class="tab" data-semester="2-2" role="tab">2-2</button>
      <button class="tab" data-semester="3-1" role="tab">3-1</button>
      <button class="tab" data-semester="3-2" role="tab">3-2</button>
    </div>

    <div class="chips" id="categoryChips" role="group" aria-label="영역 필터">
      <button class="chip is-active" data-category="ALL">전체</button>
      <button class="chip" data-category="Core">Core</button>
      <button class="chip" data-category="Node">Node</button>
      <button class="chip" data-category="Elective">Elective</button>
    </div>
  </section>

  <!-- 리스트 -->
  <main id="courseList" class="list" aria-live="polite"></main>

  <!-- 바텀시트 상세 -->
  <div id="sheetBackdrop" class="backdrop" hidden></div>
  <aside id="detailSheet" class="sheet" aria-hidden="true" aria-labelledby="sheetTitle" role="dialog">
    <!-- ☆ 헤더 밖으로 이동한 닫기 버튼: 시트 외곽에 플로팅 -->
    <button class="icon-btn sheet-close" id="closeSheet" aria-label="닫기">✕</button>

    <header class="sheet-head">
      <div class="sheet-meta">
        <span id="sheetSemester" class="badge"></span>
        <span id="sheetCategory" class="badge"></span>
      </div>
      <h2 id="sheetTitle" class="sheet-title"></h2>
      <!-- 제목 바로 아래 학점 -->
      <p id="sheetCredit" class="sheet-credit"></p>
    </header>

    <!-- 제목/학점 아래 구분선 -->
    <div class="sheet-divider" aria-hidden="true"></div>

    <section class="sheet-body" id="sheetBody"></section>

    <footer class="sheet-foot">
      <div id="sheetTags" class="tagrow"></div>
      <button class="primary-btn" id="openSyllabus" disabled>해당 노드 보기</button>
    </footer>
  </aside>

  <!-- 카드 템플릿 -->
  <template id="courseCardTmpl">
    <article class="card" role="button">
      <div class="card-head">
        <div class="datebox">
          <div class="dow"></div>
        </div>
        <div class="pill"></div>
      </div>
      <div class="card-body">
        <h3 class="title"></h3>
      </div>
    </article>
  </template>

  <script>
    // -------- 색상: 카테고리별 통일 --------
    const CATEGORY_COLORS = {
      Core: "#2a76ff",
      Node: "#ff7a1a",
      Elective: "#7048e8"
    };

    // -------- 과목 설 --------
    const courseDescriptions = {
      "Creative Thinking(1)": "디자이너가 갖추어야 할 창의적 자세의 기본적이고 필수적 소양 과목으로 폭넓은 학제적 접근을 바탕으로 독창적인 문제 제기와 발상을 전환하는 사고를 기르는 것을 목표로 한다. 다양한 주제에 관하여 고민해 보며, 스스로 재해석하여 자신의 생각을 여러 매체에 적용하여 구체화한다. 이를 통하여 디자인 이론과 실제 간의 경계를 규정하지 않는 자유로운 발상과 조형의 기초를 겸비할 수 있는 기반을 구축한다.",
      "Interaction Lab(1)": "코딩을 통해 스크린 기반의 인터렉티브한 디자인을 할 수 있는 능력을 길러주는 도구과목이다. Scratch 언어를 사용 하여 이미지, 텍스트, 애니메이션, 비디오, 사운드에 인터렉션을 부여하는 멀티미디어 코딩과 Processing 언어를 사용 하여 點/線/面/色/文을 운용하는 코딩을 다룬다.",
      "Making Workshop(1)": "입체적인 조형디자인을 위한 기초 입문 과목으로서 사물을 구성하는 물성을 이해하고 형태를 이끌어 내는 폼 기빙 (form giving) 능력을 학습한다.",
      "Visual Studio(1)": "기초 드로잉 실습을 통해 표현 능력의 시각적 지평을 확장하며 더 나아가 다양한 재료와 표현 방법 등을 학습함으로써 본인이 전달하고자 하는 의미와 메시지를 자유롭게 표현할 수 있는 시각화 능력을 고취시킨다.",
      "미술사": "인류 역사와 더불어 발전되어온 조형적인 활동에 대해서 문화사적인 소양을 기르는 과목으로서 역사 속에 나타난 미술작품의 생산 과정에서 영향을 받은 다양한 factor 들과 여러 양상들의 혁신적 순간과 개선의 흐름이 사회 문화 정치에 어떤 영향을 받고 있는지 알아본다.",
      "기초사진": "21세기 들어 시각이미지의 주축으로 자리 잡은 사진을 이해하고 기본적인 카메라 메카니즘을 익혀 활용한다.",
      "Creative Thinking(2)": "창의적 사고와 실험적 방법론으로 체화하고 학습한 과정을 토대로 아이디어를 독창적인 개성으로 표출하기 위한 교육 과정을 목표로 한다.",
      "Interaction Lab(2)": "아두이노를 통해 전자회로와 피지컬컴퓨팅 기반의 인터렉티브한 디자인을 할 수 있는 능력을 길러주는 도구 과목이다.",
      "Making Workshop(2)": "Making Workshop(1)의 연계과목으로서, 사물을 구성하고 있는 다양한 재료와 해당 재료의 가공에 필요한 도구 및 제작 공정을 이해하고 실습한다.",
      "Visual Studio(2)": "조형의 기본 요소인 점,선,면의 특징과 원리를 이해하고 이를 활용한 다양한 평면 조형 구성 및 실험적 조형 구성 능력의 함양을 목표로 한다.",
      "디자인사": "디자인 영역이 점차로 확대되고 있는 시대적 상황 속에서 디자인의 역사에 대해 배움으로써 다양한 수업에서 활용할 수 있는 기본적인 학문적 소양을 갖추는 것을 목표로 한다.",
      "기초영상": "비디오 카메라의 사용법 등 촬영의 기초를 익히고 샷, 시퀀스, 롱테이크 등 기본적인 영상문법을 배운다.",
      "콘셉트드로잉": "기초드로잉 능력을 기반으로 개념적 사고를 가능케 하는 드로잉을 실험한다.",
      "Design Process": "사회·문화·기술 트렌드를 해석하고, 디자인방법론과 프로세스를 프로젝트로 경험한다.",
      "Interaction Lab(3)": "웹 제작을 위한 HTML/CSS의 기초를 실습하고 웹 인터랙션을 학습한다.",
      "Making Workshop(3)": "프로토타이핑 구현능력을 학습한다.",
      "Typography(1)": "타이포그래피의 기본 역사/이론과 실습.",
      "Motion Graphics(1)": "모션그래픽 기본 개념 및 도구 학습.",
      "사운드디자인": "디지털 사운드 편집과 시퀀서 기초.",
      "카피라이팅": "광고 카피 창작 프로세스 이론과 실습.",
      "테크니컬스케치 & 렌더링": "제도·스케치 및 마커 렌더링 기초.",
      "3D 오브젝트 모델링(1)": "3D 모델링 소프트웨어 기초.",
      "디지털포토그래피": "스튜디오 조명·후보정 등 중급 사진.",
      "Design Convergence Studio(1)": "Core 통합 프로젝트와 전시.",
      "Typography(2)": "타입·이미지의 다양한 활용 심화.",
      "디지털메이커스랩": "디지털 패브리케이션 도구 실습.",
      "웹디자인": "웹 서비스 기획·디자인·구현 실습.",
      "컬러플래닝": "색채 분석과 팔레트 도출, 적용.",
      "Design Theory & Trends": "디자인 이론 및 역사 고찰.",
      "Motion Graphics(2)": "스토리텔링 중심 모션디자인 심화.",
      "Advertising Design": "상업용 이미지 제작과 기초이론.",
      "일러스트레이션": "시각 이미지의 이론 및 실기.",
      "Emotional Design": "행동·심리 기반의 가치 제안.",
      "프로덕트 아뜰리에": "장인정신과 프로덕트·공예 협업.",
      "3D 오브젝트 모델링(2)": "모델링·매핑·렌더링 심화.",
      "Material Study": "다양한 재료의 특성·가공 연구.",
      "3D 모션그래픽스(1)": "3D 그래픽 기초, 모델링·라이팅 등.",
      "Design Convergence Studio(2)": "팀티칭 기반 융합 프로젝트.",
      "Cultural Contents Design(1)": "상업 영상 제작 프로세스 학습.",
      "Visual Language(1)": "전통적 시각커뮤니케이션 심화.",
      "Graphic Design & Technology(1)": "뉴미디어 관점의 그래픽 연구.",
      "Information Design(1)": "정보 시각화와 인포그래픽 실습.",
      "UX Design(1)": "현장 중심 리서치와 모델링.",
      "Interface Design(1)": "구조·GUI 등 인터페이스 설계 실습.",
      "Interactive Media Design(1)": "인터랙티브 미디어 기획·제작.",
      "Contextual Object Design(1)": "맥락 기반 오브젝트 디자인 프로세스.",
      "Smart Life Design(1)": "사물·인터랙션 관계성 학습.",
      "인터렉티브 스토리텔링": "비선형 콘텐츠 디자인과 실습.",
      "유니버셜디자인": "보편적 인간공학 디자인 연구.",
      "Big Data": "통계 기반 데이터 분석·활용.",
      "3D 모션그래픽스(2)": "3D 모델링/특수효과 심화.",
      "Communication & Ideation": "커뮤니케이션 콘셉트·아이디어 전개.",
      "편집디자인": "인쇄물 레이아웃과 제작 실습.",
      "브랜드디자인": "브랜딩 전략 기획과 디자인.",
      "Identity & Contents Design": "브랜드 아이덴티티 프로그램 제작.",
      "Visual Essay": "일러스트 기반 스토리텔링 심화.",
      "비주얼머천다이징": "공간·디스플레이·조명 연출.",
      "커뮤니티디자인": "지역 정체성 기반 융합 디자인.",
      "CMF 디자인": "Color/Material/Finish 연구.",
      "Design Convergence Studio(3)": "팀티칭 융합 프로젝트 심화.",
      "Cultural Contents Design(2)": "캠페인 중심 통합 광고 프로젝트.",
      "Visual Language(2)": "전통 매체 중심 시각커뮤니케이션 심화.",
      "Graphic Design & Technology(2)": "디지털 그래픽 접목 심화.",
      "Information Design(2)": "동적/인터랙티브 정보디자인.",
      "UX Design(2)": "평가·개선·경험 관리 중심 UX.",
      "Interface Design(2)": "확장 인터페이스 리서치·제작.",
      "Interactive Media Design(2)": "인터랙티브 미디어 심화.",
      "Contextual Object Design(2)": "사용성 개선·경험 혁신 체험.",
      "Smart Life Design(2)": "테크놀로지 기반 제안·연출.",
      "사물인터넷": "근/중/원거리 통신 기반 IoT 프로토타입.",
      "모바일디자인": "모바일 UX/UI·프로토타이핑.",
      "VR": "Unity 기반 반응형 몰입 환경.",
      "디자인전략": "비즈니스 모델·사례 분석·실습.",
      "Book Design": "콘텐츠 기획 중심 북디자인.",
      "Branding & Media [캡스톤디자인]": "브랜딩 심화·실행·분석.",
      "패키지디자인": "표면·스킨·구조 완성도 향상.",
      "Branded Environments": "환경 적용 시각시스템 제안.",
      "지속가능디자인": "적정기술과 착한 디자인.",
      "오브젝트 & 스타일링": "표면 레이아웃·패턴·그래픽 처리.",
      "Design Challenge [캡스톤디자인]": "자율 주제 캡스톤 프로젝트.",
      "Advanced Typography": "타이포그래피 심화."
    };

    // -------- 원본 표 --------
    const RAW = [
      { semester: "1-1", category: "Core",     titles: ["Creative Thinking(1)", "Interaction Lab(1)", "Making Workshop(1)", "Visual Studio(1)"] },
      { semester: "1-1", category: "Elective", titles: ["미술사", "기초사진", "색채의 이해"] },
      { semester: "1-2", category: "Core",     titles: ["Creative Thinking(2)", "Interaction Lab(2)", "Making Workshop(2)", "Visual Studio(2)"] },
      { semester: "1-2", category: "Elective", titles: ["디자인사", "기초영상", "콘셉트드로잉"] },
      { semester: "2-1", category: "Core",     titles: ["Design Process", "Interaction Lab(3)", "Making Workshop(3)", "Typography(1)"] },
      { semester: "2-1", category: "Elective", titles: ["Motion Graphics(1)", "사운드디자인", "카피라이팅", "테크니컬스케치 & 렌더링", "3D 오브젝트 모델링(1)", "디지털포토그래피"] },
      { semester: "2-2", category: "Core",     titles: ["Design Convergence Studio(1)", "Typography(2)"] },
      { semester: "2-2", category: "Elective", titles: ["디지털메이커스랩", "웹디자인", "컬러플래닝", "Design Theory & Trends", "Motion Graphics(2)", "Advertising Design", "일러스트레이션", "Emotional Design", "프로덕트 아뜰리에", "3D 오브젝트 모델링(2)", "Material Study", "3D 모션그래픽스(1)"] },
      { semester: "3-1", category: "Core",     titles: ["Design Convergence Studio(2)"] },
      { semester: "3-1", category: "Node",     titles: ["Cultural Contents Design(1)", "Visual Language(1)", "Graphic Design & Technology(1)", "Information Design(1)", "UX Design(1)", "Interface Design(1)", "Interactive Media Design(1)", "Contextual Object Design(1)", "Smart Life Design(1)", "Product User Test & Scenario(1)"] },
      { semester: "3-1", category: "Elective", titles: ["크리에이티브코딩", "인터렉티브 스토리텔링", "유니버셜디자인", "Big Data", "3D 모션그래픽스(2)", "Communication & Ideation", "편집디자인", "브랜드디자인", "Identity & Contents Design", "Visual Essay", "비주얼머천다이징", "커뮤니티디자인", "CMF 디자인"] },
      { semester: "3-2", category: "Core",     titles: ["Design Convergence Studio(3)"] },
      { semester: "3-2", category: "Node",     titles: ["Cultural Contents Design(2)", "Visual Language(2)", "Graphic Design & Technology(2)", "Information Design(2)", "UX Design(2)", "Interface Design(2)", "Interactive Media Design(2)", "Contextual Object Design(2)", "Smart Life Design(2)", "Product User Test & Scenario(2)"] },
      { semester: "3-2", category: "Elective", titles: ["인터랙티브3D", "데이터기반디자인스튜디오", "사물인터넷", "모바일디자인", "VR", "디자인전략", "Book Design", "Branding & Media [캡스톤디자인]", "패키지디자인", "Branded Environments", "지속가능디자인", "오브젝트 & 스타일링", "Design Challenge [캡스톤디자인]", "Advanced Typography"] }
    ];

    // -------- 유틸 --------
    const toId = (title) => title.replace(/\s+/g, "_").replace(/[^\w가-힣()&\-\[\]]/g, "").slice(0,40);
    const getCredit = (title) => (title === "미술사" || title === "디자인사") ? 2 : 3;
    const norm = (s) => s.replace(/\s+/g,'').toLowerCase();
    const hexToRgba = (hex, a=1) => {
      const m = hex.replace('#','');
      const r = parseInt(m.substring(0,2),16);
      const g = parseInt(m.substring(2,4),16);
      const b = parseInt(m.substring(4,6),16);
      return `rgba(${r},${g},${b},${a})`;
    };

    // -------- RAW → COURSES --------
    const COURSES = RAW.flatMap(row =>
      row.titles.map(t => ({
        id: toId(t),
        title: t,
        semester: row.semester,
        category: row.category,
        description: courseDescriptions[t] || "설명 없음",
        relatedNodes: []
      }))
      );

    // -------- 연계 노드 그룹(행님 제공) → 매핑 --------
    const groupData = [
      { name: "Interactive Media Design", subjects: ["Interaction Lab(1)", "Interaction Lab(3)", "사운드디자인", "Interactive Media Design(1)", "크리에이티브코딩", "인터렉티브 스토리텔링", "Interactive Media Design(2)", "인터랙티브3D", "데이터기반디자인스튜디오", "사물인터넷"] },
      { name: "Interface Design", subjects: ["Interaction Lab(1)","색채의 이해", "Visual Studio(2)","Interaction Lab(3)", "웹디자인", "컬러플래닝", "Typography(2)", "Interface Design(1)", "인터렉티브 스토리텔링", "Interface Design(2)", "모바일디자인", "VR", "사물인터넷"] },
      { name: "UX Design", subjects: ["Interaction Lab(1)", "Interaction Lab(3)", "Motion Graphics(1)","Motion Graphics(2)","3D 모션그래픽스(1)", "Typography(2)", "웹디자인", "UX Design(1)", "인터렉티브 스토리텔링", "유니버셜 디자인", "Big Data", "3D 모션그래픽스(2)", "UX Design(2)", "지속가능디자인", "VR", "디자인전략"] },
      { name: "Information Design", subjects: ["Interaction Lab(1)", "Visual Studio(2)", "Interaction Lab(3)", "Motion Graphics(1)", "Typography(2)", "웹디자인", "Motion Graphics(2)", "Information Design(1)", "Big Data", "3D 모션그래픽스(2)", "Information Design(2)", "VR", "모바일디자인"] },
      { name: "Graphic Design & Technology", subjects: ["Visual Studio(2)", "Typography(2)", "Graphic Design & Technology(1)", "Communication & Ideation", "편집디자인", "Graphic Design & Technology(2)", "Book Design", "Advanced Typography"] },
      { name: "Cultural Contents Design", subjects: ["기초사진", "Visual Studio(2)", "기초영상", "카피라이팅", "디지털포토그래피", "Typography(2)", "Advertising Design", "Cultural Contents Design(1)", "브랜드디자인", "Identity & Contents Design", "Cultural Contents Design(2)", "디자인전략", "Branding & Media [캡스톤디자인]", "패키지디자인"] },
      { name: "Visual Language", subjects: ["Visual Studio(2)", "콘셉트드로잉", "Typography(2)", "일러스트레이션", "Visual Language(1)", "편집디자인", "Identity & Contents Design", "Visual Essay", "Visual Language(2)", "Book Design", "Branding & Media [캡스톤디자인]", "Advanced Typography"] },
      { name: "Product User Test & Scenario", subjects: ["Making Workshop(1)", "Making Workshop(3)", "Emotional Design", "프로덕트 아뜰리에", "Product User Test & Scenario(1)", "비주얼머천다이징", "커뮤니케이션디자인", "Product User Test & Scenario(2)", "Design Challenge [캡스톤디자인]", "Branded Environments", "디자인전략", "지속가능디자인"] },
      { name: "Contextual Object Design", subjects: ["테크니컬스케치 & 렌더링","Motion Graphics(1)", "3D 오브젝트 모델링(1)","3D 오브젝트 모델링(2)", "Motion Graphics(2)", "Material Study", "Contextual Object Design(1)", "CMF 디자인", "Contextual Object Design(2)", "오브젝트 & 스타일링", "패키지 디자인", "Design Challenge [캡스톤디자인]"] },
      { name: "Smart Life Design", subjects: ["Making Workshop(1)", "Making Workshop(3)", "3D 오브젝트 모델링(1)", "3D 오브젝트 모델링(2)", "디지털메이커스랩", "Smart Life Design(1)", "유니버셜디자인", "Smart Life Design(2)", "지속가능디자인", "사물인터넷", "모바일디자인"] }
    ];
    const byNormTitle = new Map(COURSES.map(c => [norm(c.title), c]));
    groupData.forEach(g => g.subjects.forEach(s => {
      const t = byNormTitle.get(norm(s));
      if (t && !t.relatedNodes.includes(g.name)) t.relatedNodes.push(g.name);
    }));

    // -------- 상태 --------
    let currentSemester = "ALL";
    let currentCategory = "ALL";

     // ★ 하이라이트 상태 추가
    let selectedNode = null;
    let pendingNodeInSheet = null;
    const GROUP_BY_NAME = new Map(groupData.map(g => [g.name, new Set(g.subjects.map(s => norm(s)))]));

    // -------- DOM --------
    const listEl = document.getElementById("courseList");
    const tabWrap = document.getElementById("semesterTabs");
    const chipWrap = document.getElementById("categoryChips");
    const sheet = document.getElementById("detailSheet");
    const backdrop = document.getElementById("sheetBackdrop");
    const closeSheetBtn = document.getElementById("closeSheet");
    const tCard = document.getElementById("courseCardTmpl");
    const sheetSemester = document.getElementById("sheetSemester");
    const sheetCategory = document.getElementById("sheetCategory");
    const sheetTitle = document.getElementById("sheetTitle");
    const sheetCredit = document.getElementById("sheetCredit");
    const sheetBody = document.getElementById("sheetBody");
    const sheetTags = document.getElementById("sheetTags");
    const openSyllabus = document.getElementById("openSyllabus");

    // -------- 렌더러 --------
    function render() {
      listEl.innerHTML = "";
      const data = COURSES.filter(c =>
        (currentSemester === "ALL" || c.semester === currentSemester) &&
        (currentCategory === "ALL" || c.category === currentCategory)
        );
      listEl.classList.toggle("has-highlight", !!selectedNode);

      if (data.length === 0) {
        listEl.innerHTML = `<p class="empty">해당 조건의 과목이 없습니다.</p>`;
        return;
      }

      data.forEach((c) => {
        const node = tCard.content.firstElementChild.cloneNode(true);
        node.style.setProperty("--card-color", CATEGORY_COLORS[c.category] || "#333");
        node.querySelector(".dow").textContent = c.semester.replace("-", "학년 ") + "학기";
        node.querySelector(".pill").textContent = c.category;
        node.querySelector(".title").textContent = c.title;
        node.addEventListener("click", () => openSheet(c));

        // ★ 하이라이트 적용
        if (selectedNode) {
          const inNode = GROUP_BY_NAME.get(selectedNode)?.has(norm(c.title));
          node.classList.toggle("is-hl", !!inNode);
          node.classList.toggle("is-dim", !inNode);
        }

        listEl.appendChild(node);
      });
    }

    // -------- 시트 --------
    function paintBadges(course){
      const catColor = CATEGORY_COLORS[course.category] || "#333";
      // Category 배지는 진하게
      sheetCategory.style.backgroundColor = catColor;
      sheetCategory.style.color = "#fff";
      sheetCategory.style.borderColor = "transparent";
      // Semester 배지는 옅은 틴트
      sheetSemester.style.backgroundColor = hexToRgba(catColor, 0.12);
      sheetSemester.style.borderColor = hexToRgba(catColor, 0.25);
      sheetSemester.style.color = "#333";
    }

    function openSheet(course) {
      sheetSemester.textContent = course.semester;
      sheetCategory.textContent = course.category;
      sheetTitle.textContent = course.title;
      sheetCredit.textContent = `${getCredit(course.title)}학점`;
      paintBadges(course);

      sheetBody.innerHTML = `
      <p class="desc">${course.description}</p>
      <div class="related">
        <h4>연계 노드</h4>
        <div class="tagrow">
          ${
            (course.relatedNodes && course.relatedNodes.length)
            ? course.relatedNodes.map(r => `<button class="tag tag-node" data-node="${r}" type="button">${r}</button>`).join("")
            : '<span class="tag" aria-disabled="true">연계 노드 없음</span>'
          }
        </div>
          </div>`;

    // ★ 노드 태그 선택 로직
          pendingNodeInSheet = null;
          sheetBody.querySelectorAll(".tag-node").forEach(btn => {
            btn.addEventListener("click", () => {
              sheetBody.querySelectorAll(".tag-node").forEach(b => b.classList.remove("is-selected"));
              btn.classList.add("is-selected");
              pendingNodeInSheet = btn.dataset.node;
              openSyllabus.disabled = false;
            });
          });

          openSyllabus.textContent = "해당 노드 보기";
          openSyllabus.disabled = !(course.relatedNodes && course.relatedNodes.length);

          backdrop.hidden = false;
          sheet.setAttribute("aria-hidden", "false");
          sheet.classList.add("is-open");
          document.body.style.overflow = "hidden";
        }

        function closeSheet() {
          sheet.classList.remove("is-open");
          sheet.setAttribute("aria-hidden", "true");
          backdrop.hidden = true;
          document.body.style.overflow = "";
        }

         // -------- 하이라이트 인디케이터 --------
        function updateNodeIndicator(){
          let badge = document.getElementById("nodeIndicator");
          if (!selectedNode) {
            if (badge) badge.remove();
            return;
          }
          if (!badge) {
            badge = document.createElement("button");
            badge.id = "nodeIndicator";
            badge.className = "chip chip-node-indicator";
            badge.type = "button";
            badge.addEventListener("click", () => { selectedNode = null; render(); });
            chipWrap.appendChild(badge);
          }
          badge.textContent = `노드 하이라이트: ${selectedNode} ✕`;
        }

    // -------- 이벤트 --------
        tabWrap.addEventListener("click", (e) => {
          const btn = e.target.closest(".tab");
          if (!btn) return;
          [...tabWrap.children].forEach(b => b.classList.toggle("is-active", b === btn));
          currentSemester = btn.dataset.semester;
          render();
        });
        chipWrap.addEventListener("click", (e) => {
          const chip = e.target.closest(".chip");
          if (!chip) return;
          [...chipWrap.children].forEach(c => c.classList.toggle("is-active", c === chip));
          currentCategory = chip.dataset.category;
          render();
        });
        closeSheetBtn.addEventListener("click", closeSheet);
        backdrop.addEventListener("click", closeSheet);
        document.addEventListener("keydown", (e) => { if (e.key === "Escape") closeSheet(); });

  // ★ "해당 노드 보기" 클릭 → 하이라이트 적용
        openSyllabus.addEventListener("click", () => {
          if (!pendingNodeInSheet) return;
          selectedNode = pendingNodeInSheet;
          closeSheet();
          render();
        });

    // -------- 초기 렌더 --------
        render();
      </script>
    </body>
    </html>
